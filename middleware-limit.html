<html>
  <head>
    <title>
      
        Connect - limit
      
    </title>
    <link rel='stylesheet' href='main.css' />
  </head>
  <body>
    <div id="content">
      
        <h1>limit</h1>
        <span class="filename">lib/middleware/limit.js</span>
      

      
      
        
        
        
          <div class="comment">
            
            <p class="description"><p>Limit request bodies to the given size in <code>bytes</code>.</p></p>

            
              <div class="body">
                <p>A string representation of the bytesize may also be passed,
for example &quot;5mb&quot;, &quot;200kb&quot;, &quot;1gb&quot;, etc.</p>

<h2>Examples</h2>

<pre><code>var server = connect(
  connect.limit(&#39;5.5mb&#39;)
).listen(3000);</code></pre>

<h2>TODO pause EV_READ</h2>
              </div>
            

            
              <ul class="tags">
              
                

                

                

                
                  <li class="param"><em>param</em> <span class="types">Number, String</span> <span class="name">bytes</span> <span class="description"></span></li>
                
              
                
                  <li class="return"><em>returns</em> <span class="types">Function</span></li>
                

                

                

                
              
                

                
                  <li class="api"><em>api</em> <span class="visibility">public</span></li>
                

                

                
              
              </ul>

<!--            
              <pre class="code">
                <code>
module.exports = function limit(bytes){
  if ('string' == typeof bytes) bytes = parse(bytes);
  if ('number' != typeof bytes) throw new Error('limit() bytes required');
  return function limit(req, res, next){
    var received = 0
      , len = req.headers['content-length']
        ? parseInt(req.headers['content-length'], 10)
        : null;

    // deny the request
    function deny() {
      req.destroy();
    }

    // self-awareness
    if (req._limit) return next();
    req._limit = true;

    // limit by content-length
    if (len && len > bytes) {
      res.statusCode = 413;
      res.end('Request Entity Too Large');
      return;
    }

    // limit
    req.on('data', function(chunk){
      received += chunk.length;
      if (received > bytes) deny();
    });

    next();
  };
};
                </code>
              </pre>
             -->
          
          </div>
        
      
        
      
    </div>
  </body>
</html>