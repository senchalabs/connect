<html>
  <head>
    <title>
      
        Connect - http
      
    </title>
    <link rel='stylesheet' href='main.css' />
  </head>
  <body>
    <div id="content">
      
        <h1>http</h1>
        <span class="filename">lib/http.js</span>
      

      
      
        
        
        
        
          <div class="comment">
            
            <p class="description"><p>Initialize a new <code>Server</code> with the given <code>middleware</code>.</p></p>

            
              <div class="body">
                <h2>Examples</h2>

<pre><code><span class="keyword">var</span> <span class="variable">server</span> = <span class="variable">connect</span>.<span class="variable">createServer</span>(
    <span class="variable">connect</span>.<span class="variable">favicon</span>()
  , <span class="variable">connect</span>.<span class="variable">logger</span>()
  , <span class="variable">connect</span>.<span class="variable">static</span>(<span class="variable">__dirname</span> + "/<span class="variable">public</span>")
);</code></pre>
              </div>
            

            
              <ul class="tags">
              
                

                

                

                
              
                
                  <li class="return"><em>returns</em> <span class="types">Server</span></li>
                

                

                

                
              
                

                
                  <li class="api"><em>api</em> <span class="visibility">public</span></li>
                

                

                
              
              </ul>

<!--            
              <pre class="code">
                <code>
<span class="keyword">var</span> <span class="class">Server</span> = <span class="variable">exports</span>.<span class="class">Server</span> = <span class="keyword">function</span> <span class="class">HTTPServer</span>(<span class="variable">middleware</span>) {
  <span class="this">this</span>.<span class="variable">stack</span> = [];
  <span class="variable">middleware</span>.<span class="variable">forEach</span>(<span class="keyword">function</span>(<span class="variable">fn</span>){
    <span class="this">this</span>.<span class="variable">use</span>(<span class="variable">fn</span>);
  }, <span class="this">this</span>);
  <span class="variable">http</span>.<span class="class">Server</span>.<span class="variable">call</span>(<span class="this">this</span>, <span class="this">this</span>.<span class="variable">handle</span>);
};
                </code>
              </pre>
             -->
          
          </div>
        
      
        
        
        
          <div class="comment">
            
              <h3 class="method">.use()</h3>
            
            <p class="description"><p>Utilize the given middleware <code>handle</code> to the given <code>route</code>,
defaulting to <em>/</em>. This &quot;route&quot; is the mount-point for the
middleware, when given a value other than <em>/</em> the middleware
is only effective when that segment is present in the request&#39;s
pathname.</p></p>

            
              <div class="body">
                <p>For example if we were to mount a function at <em>/admin</em>, it would
be invoked on <em>/admin</em>, and <em>/admin/settings</em>, however it would
not be invoked for <em>/</em>, or <em>/posts</em>.</p>

<p>This is effectively the same as passing middleware to <code>connect.createServer()</code>,
however provides a progressive api.</p>

<h2>Examples</h2>

<pre><code> <span class="keyword">var</span> <span class="variable">server</span> = <span class="variable">connect</span>.<span class="variable">createServer</span>();
 <span class="variable">server</span>.<span class="variable">use</span>(<span class="variable">connect</span>.<span class="variable">favicon</span>());
 <span class="variable">server</span>.<span class="variable">use</span>(<span class="variable">connect</span>.<span class="variable">logger</span>());
 <span class="variable">server</span>.<span class="variable">use</span>(<span class="variable">connect</span>.<span class="variable">static</span>(<span class="variable">__dirname</span> + "/<span class="variable">public</span>"));</code></pre>

<p>If we wanted to prefix static files with <em>/public</em>, we could
&quot;mount&quot; the <code>static()</code> middleware:</p>

<pre><code> <span class="variable">server</span>.<span class="variable">use</span>("<span class="regexp">/public&#39;, connect.static(__dirname + &#39;/public</span>"));</code></pre>

<p>This api is chainable, meaning the following is valid:</p>

<pre><code> <span class="variable">connect</span>.<span class="variable">createServer</span>()
   .<span class="variable">use</span>(<span class="variable">connect</span>.<span class="variable">favicon</span>())
   .<span class="variable">use</span>(<span class="variable">connect</span>.<span class="variable">logger</span>())
   .<span class="variable">use</span>(<span class="variable">connect</span>.<span class="variable">static</span>(<span class="variable">__dirname</span> + "/<span class="variable">public</span>"))
   .<span class="variable">listen</span>(<span class="number integer">3000</span>);</code></pre>
              </div>
            

            
              <ul class="tags">
              
                

                

                

                
                  <li class="param"><em>param</em> <span class="types">String, Function</span> <span class="name">route</span> <span class="description">or handle</span></li>
                
              
                

                

                

                
                  <li class="param"><em>param</em> <span class="types">Function</span> <span class="name">handle</span> <span class="description"></span></li>
                
              
                
                  <li class="return"><em>returns</em> <span class="types">Server</span></li>
                

                

                

                
              
                

                
                  <li class="api"><em>api</em> <span class="visibility">public</span></li>
                

                

                
              
              </ul>

<!--            
              <pre class="code">
                <code>
<span class="class">Server</span>.<span class="variable">prototype</span>.<span class="variable">use</span> = <span class="keyword">function</span>(<span class="variable">route</span>, <span class="variable">handle</span>){
  <span class="this">this</span>.<span class="variable">route</span> = <span class="string">'/'</span>;

  <span class="comment">// default route to '/'</span>
  <span class="keyword">if</span> (<span class="string">'string'</span> != <span class="keyword">typeof</span> <span class="variable">route</span>) {
    <span class="variable">handle</span> = <span class="variable">route</span>;
    <span class="variable">route</span> = <span class="string">'/'</span>;
  }

  <span class="comment">// multiples</span>
  <span class="keyword">if</span> (<span class="variable">arguments</span>.<span class="variable">length</span> > <span class="number integer">2</span>) {
    <span class="keyword">return</span> <span class="class">Array</span>.<span class="variable">prototype</span>.<span class="variable">slice</span>.<span class="variable">call</span>(<span class="variable">arguments</span>, <span class="number integer">1</span>).<span class="variable">forEach</span>(<span class="keyword">function</span>(<span class="variable">fn</span>){
      <span class="this">this</span>.<span class="variable">use</span>(<span class="variable">route</span>, <span class="variable">fn</span>);
    }, <span class="this">this</span>);
  }

  <span class="comment">// wrap sub-apps</span>
  <span class="keyword">if</span> (<span class="string">'function'</span> == <span class="keyword">typeof</span> <span class="variable">handle</span>.<span class="variable">handle</span>) {
    <span class="keyword">var</span> <span class="variable">server</span> = <span class="variable">handle</span>;
    <span class="variable">server</span>.<span class="variable">route</span> = <span class="variable">route</span>;
    <span class="variable">handle</span> = <span class="keyword">function</span>(<span class="variable">req</span>, <span class="variable">res</span>, <span class="variable">next</span>) {
      <span class="variable">server</span>.<span class="variable">handle</span>(<span class="variable">req</span>, <span class="variable">res</span>, <span class="variable">next</span>);
    };
  }

  <span class="comment">// wrap vanilla http.Servers</span>
  <span class="keyword">if</span> (<span class="variable">handle</span> <span class="variable">instanceof</span> <span class="variable">http</span>.<span class="class">Server</span>) {
    <span class="variable">handle</span> = <span class="variable">handle</span>.<span class="variable">listeners</span>(<span class="string">'request'</span>)[<span class="number integer">0</span>];
  }

  <span class="comment">// normalize route to not trail with slash</span>
  <span class="keyword">if</span> (<span class="string">'/'</span> == <span class="variable">route</span>[<span class="variable">route</span>.<span class="variable">length</span> - <span class="number integer">1</span>]) {
    <span class="variable">route</span> = <span class="variable">route</span>.<span class="variable">substr</span>(<span class="number integer">0</span>, <span class="variable">route</span>.<span class="variable">length</span> - <span class="number integer">1</span>);
  }

  <span class="comment">// add the middleware</span>
  <span class="this">this</span>.<span class="variable">stack</span>.<span class="variable">push</span>({ <span class="variable">route</span>: <span class="variable">route</span>, <span class="variable">handle</span>: <span class="variable">handle</span> });

  <span class="comment">// allow chaining</span>
  <span class="keyword">return</span> <span class="this">this</span>;
};
                </code>
              </pre>
             -->
          
          </div>
        
      
        
      
    </div>
  </body>
</html>